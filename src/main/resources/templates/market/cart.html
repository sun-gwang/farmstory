
<!DOCTYPE html>
<!-- Default Layout Import-->
<html lang="en"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/common/layouts/defaultLayout}"
      layout:fragment="Content"
>
<head>
    <meta charset="UTF-8">
    <title>팜스토리::장바구니</title>
    <link rel="stylesheet" th:href="@{../css/style.css}"/>
    <link rel="stylesheet" th:href="@{../css/style2.css}"/>

    <style>
        #sub > .market > .cart > form> table {
            width: 100%;
            border-collapse: collapse;
            border-top: 1px solid #111;
            border-bottom: 1px solid #111;
            margin-top: 10px;
        }

        #sub > .market > .cart > form > table {
            width: 100%;
            border-collapse: collapse;
            border-top: 1px solid #111;
            border-bottom: 1px solid #111;
            margin-top: 10px;
        }

        #sub > .market > .cart > form > table th {
            padding: 10px;
            background-color: #e5ecef;
            border-bottom: 1px solid #d1dee2;
        }

        #sub > .market > .cart > form > table tr {
            border-bottom: 1px solid #eee;
        }


        #sub > .market > .cart > form > table tr > td {
            padding: 10px;
            box-sizing: border-box;
            color: #777;
            text-align: center;
        }


        #cartList .thumb{
            max-width: 100px;
            max-height: 100px;
        }

    </style>
</head>
<script th:src="@{/js/util.js}"></script>
<script>
    
    window.onload = function (){

        // 선택삭제 버튼 클릭
        document.querySelector("input[name='delCart']").addEventListener("click", function (){
            // 선택된 상품들
            let selectedProducts = document.querySelectorAll("input[name='checkCart']:checked");

            // 선택된 상품 삭제
            selectedProducts.forEach(function (product){
                let productRow = product.closest("tr"); // 상품의 행
                productRow.parentNode.removeChild(productRow); // 상품 행 삭제
            });

        })


    }

</script>

<div id="sub">
    <div><img th:src="@{../images/sub_top_tit2.png}" alt="MARKET"></div>
    <section class="market">
        <aside>
            <img th:src="@{../images/sub_aside_cate2_tit.png}" alt="장보기"/>

            <ul class="lnb">
                <li class="on"><a th:href="@{/market/list}">장보기</a></li>
            </ul>
        </aside>
        <article class="cart">
            <nav>
                <img th:src="@{../images/sub_nav_tit_cate2_tit1.png}" alt="장보기"/>
                <p>
                    HOME > 장보기 > <em>장보기</em>
                </p>
            </nav>

            <!-- 내용 시작 -->
            <p class="sort">
                <a th:href="@{#}" class="on">장바구니 전체(10)</a>
            </p>
                <form id="cartList"  th:action="@{/market/cart/delete}" method="post">
                <table border="0">
                    <thead>
                    <tr>
                        <th>
                            <input type="checkbox" name="all">
                        </th>
                        <th>이미지</th>
                        <th>종류</th>
                        <th>상품명</th>
                        <th>수량</th>
                        <th>할인</th>
                        <th>포인트</th>
                        <th>가격</th>
                        <th>소계</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="empty">
                        <td colspan="9">장바구니에 상품이 없습니다.</td>
                    </tr>

                    <tr th:each="cartDTO:${cartDTOList}">
                        <td>
                            <input type="checkbox" name="checkBox"  th:value="${cartDTO.pno}">
                        </td>
                        <td>
                            <a th:href="@{#}"><img th:src="@{|/product/${cartDTO.cate}/${cartDTO.img1}|}" class="thumb" alt="사과 500g"></a>
                        </td>
                        <td th:text="${cartDTO.cate}"></td>
                        <td th:text="${cartDTO.pname}"><a th:href="@{#}"></a></td>
                        <td th:text="${cartDTO.pcount}"></td>
                        <td th:text="${cartDTO.discount} + '%'"></td>
                        <td th:text="${cartDTO.point} + 'p'"></td>
                        <td th:text="${cartDTO.price} + '원'"></td>
                        <td th:text="${cartDTO.price - (cartDTO.price * cartDTO.discount / 100)} + '원'"></td>
                    </tr>
                    </tbody>
                </table>
                <input type="submit" name="delCart" value="선택삭제">
                </form>



            <div class="info">
                    <table border="0">
                        <caption>전체합계</caption>
                        <tr>
                            <th>상품수</th>
                            <td th:text="${cartDTO.pcount}"></td>
                        </tr>
                        <tr>
                            <th>상품금액</th>
                            <td th:text="${productDTO.price * cartDTO.pcount} + '원'"></td>
                        </tr>
                        <tr>
                            <th>할인금액</th>
                            <td th:text="${((productDTO.price * cartDTO.pcount) * productDTO.discount / 100)} + '원'"></td>
                        </tr>
                        <tr>
                            <th>배송비</th>
                            <td th:text="${productDTO.delprice} + '원'" class="delivery"></td>
                        </tr>
                        <tr>
                            <th>적립 포인트</th>
                            <td th:text="${productDTO.point} + 'p'"></td>
                        </tr>
                        <tr>
                            <th>전체주문금액</th>
                            <td th:text="${(productDTO.price * cartDTO.pcount) - ((productDTO.price * cartDTO.pcount) * productDTO.discount / 100) + productDTO.delprice} + '원'" class="total"></td>
                        </tr>
                        </tr>
                    </table>

                <input type="submit" class="btnOrder" value="주문하기">

            </div>
            <!-- 내용 끝 -->

        </article>
    </section>

</div>

</html>